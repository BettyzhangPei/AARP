<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Assessing the Performance of Dietary Assessment Instruments"><title>Assessing the Performance of Dietary Assessment Instruments — NME • APDI</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Assessing the Performance of Dietary Assessment Instruments — NME"><meta property="og:description" content="Assessing the Performance of Dietary Assessment Instruments"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">APDI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Assessing the Performance of Dietary Assessment Instruments</h1>
      
      <div class="d-none name"><code>NME.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Assessing the Performance of Dietary Assessment Instruments</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">NME</span><span class="op">(</span><span class="va">Q.N.1</span>, <span class="va">Q.N.2</span>, <span class="va">Q.E.1</span>, <span class="va">Q.E.2</span>, <span class="va">F.N.1</span>, <span class="va">F.N.2</span>, <span class="va">F.E.1</span>, <span class="va">F.E.2</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>data has to be complete data.</p></dd>


<dt>Q.N.1:</dt>
<dd><p>An assessment instrument for nutrient (N) at time 1.</p></dd>


<dt>Q.N.2:</dt>
<dd><p>An assessment instrument for nutrient (N) at time 2.</p></dd>


<dt>Q.E.1:</dt>
<dd><p>An assessment instrument for total energy (E) at time 1.</p></dd>


<dt>Q.E.2:</dt>
<dd><p>An assessment instrument for total energy (E) at time 2.</p></dd>


<dt>F.N.1:</dt>
<dd><p>A reference instrument for nutrient (N) at time 1.</p></dd>


<dt>F.N.2:</dt>
<dd><p>A reference instrument for nutrient (N) at time 2.</p></dd>


<dt>F.E.1:</dt>
<dd><p>A reference instrument for total energy (E) at time 1.</p></dd>


<dt>F.E.2:</dt>
<dd><p>A reference instrument for total energy (E) at time 2.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <dl><dt>Rho.N</dt>
<dd><p>correlation coefficient between reported and true intake of nutrient N.</p></dd>

<dt>Rho.E</dt>
<dd><p>correlation coefficient between reported and true intake of total energy E.</p></dd>

<dt>Rho.R</dt>
<dd><p>correlation coefficient between reported and true intake residuals.</p></dd>

<dt>Lambda.N</dt>
<dd><p>attenuation factor of nutrient N.</p></dd>

<dt>Lambda.E</dt>
<dd><p>attenuation factor of total energy E.</p></dd>

<dt>Lambda.R</dt>
<dd><p>attenuation factor of nutrient residual R.</p></dd>

<dt>est.covariance.matrix</dt>
<dd><p>estimated covariance matrix for observed data</p></dd>

<dt>Beta.N1</dt>
<dd><p>intake-related bias of nutrient N in the FFQ</p></dd>

<dt>Beta.E1</dt>
<dd><p>intake-related bias of total energy E in the FFQ</p></dd>

<dt>Mu.T.N</dt>
<dd><p>mean of ture intake of nutrient N</p></dd>

<dt>Mu.T.E</dt>
<dd><p>mean of ture intake of total energy E</p></dd>

<dt>Mu.N0.2</dt>
<dd><p>overall bias independent of true intake of nutrient N for the 24HR</p></dd>

<dt>Mu.E0.2</dt>
<dd><p>overall bias independent of true intake of total energy E for the 24HR</p></dd>

<dt>Beta.N0.1</dt>
<dd><p>overall bias independent of true intake of nutrient N for the FFQ in the first measurement</p></dd>

<dt>Beta.N0.2</dt>
<dd><p>overall bias independent of true intake of total energy E for the FFQ in the first measurement</p></dd>

<dt>Beta.E0.1</dt>
<dd><p>overall bias independent of true intake of nutrient N for the FFQ in the first measurement</p></dd>

<dt>Beta.E0.2</dt>
<dd><p>overall bias independent of true intake of total energy E for the FFQ in the first measurement</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A package for estimating both of the correlations of a dietary assessment instrument (Q) and nutrient intake and attenuation factors and the correlations of nutrient residual.
The model is established as the measurement error model to evaluate the data collected by a food-frequency questionnaire (FFQ) using two non-consecutive 24-hour dietary recalls (24HRs) as the reference.
We employ the moment estimation method to the complete longitudinal data structure. Moreover, our method can provide the estimates of fixed effects including intake-related biases in the FFQ and overall biases of true intake for the FFQ and 24HR, respectively in the model.
Notably, the correlations with true intake and attenuation factors for energy-adjusted should be interpreted on the scale to which each particular nutrient was transformed.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Thompson, F. E., Kipnis, V., Midthune, D., Freedman, L.S., Carroll, R.J., Subar, A.F., Brown, C.C., Butcher, M.S.,  Mouw, T., Leitzmann, M. and Schatzkin, A. (2008) Performance of a food-frequency questionnaire in the us NIH--AARP (National Institutes of Health--American Association of Retired Persons) Diet and Health Study. <em>Public Health Nutrition</em>, 11, 183-195.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## example using random numbers</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># number of observed individuals:</span></span></span>
<span class="r-in"><span><span class="va">I</span><span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="co"># fixed effects in the measurement error model:</span></span></span>
<span class="r-in"><span><span class="co"># beta = (beta_N0_1, beta_N0_2, beta_N1, beta_E0_1, beta_E0_2, beta_E1)</span></span></span>
<span class="r-in"><span><span class="va">beta</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>,<span class="fl">0.32</span>,<span class="fl">0.3</span>,<span class="fl">0.35</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># mu_1 = (mu_T_N, mu_T_E, mu_N0_2, mu_E0_2)</span></span></span>
<span class="r-in"><span><span class="va">mu_1</span><span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.32</span>,<span class="fl">0.4</span>,<span class="fl">0.35</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># mu = first moments:  the mean vector of D_i</span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">mu_1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">beta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">mu_1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">beta</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">*</span><span class="va">mu_1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">beta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">*</span><span class="va">mu_1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">mu_1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">mu_1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">mu_1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">mu_1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mu</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">mu_1</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">+</span> <span class="va">mu_1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># second moments:</span></span></span>
<span class="r-in"><span><span class="co"># theta = (theta1, theta2, ..., theta15)</span></span></span>
<span class="r-in"><span><span class="co"># we notice that theta1, theta7, theta11, theta12, theta14, theta15 are variance components, then they should be set as positive numbers.</span></span></span>
<span class="r-in"><span><span class="va">theta</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># the setting of theta:</span></span></span>
<span class="r-in"><span><span class="va">theta</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.175</span> , <span class="fl">0</span>, <span class="fl">0.58</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.232</span>, <span class="fl">0.5</span>, <span class="fl">0.35</span>, <span class="fl">0</span> , <span class="fl">0.55</span> ,<span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">theta_set</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>             <span class="va">theta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>             <span class="va">theta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">12</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">13</span><span class="op">]</span>,<span class="va">theta</span><span class="op">[</span><span class="fl">13</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>             <span class="va">theta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">12</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">13</span><span class="op">]</span>,<span class="va">theta</span><span class="op">[</span><span class="fl">13</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>             <span class="va">theta</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">13</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">13</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">14</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">15</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>,<span class="va">theta</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">13</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">13</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">15</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="fl">14</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># variance covariance matrix of D_i</span></span></span>
<span class="r-in"><span><span class="co"># the observed data:</span></span></span>
<span class="r-in"><span><span class="va">D</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">8</span> , ncol<span class="op">=</span><span class="va">I</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">D</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">I</span>, <span class="va">mu</span>, <span class="va">Sigma</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'Sigma' not found</span>
<span class="r-in"><span><span class="va">Data</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Data</span><span class="op">)</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FFQ.N.1"</span>,<span class="st">"FFQ.N.2"</span>, <span class="st">"FFQ.E.1"</span>, <span class="st">"FFQ.E.2"</span>, <span class="st">"Ref.N.1"</span>, <span class="st">"Ref.N.2"</span>,<span class="st">"Ref.E.1"</span>, <span class="st">"Ref.E.2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ex1</span><span class="op">&lt;-</span> <span class="fu">NME</span><span class="op">(</span>Q.N.1<span class="op">=</span><span class="va">Data</span><span class="op">$</span><span class="va">FFQ.N.1</span>, Q.N.2<span class="op">=</span><span class="va">Data</span><span class="op">$</span><span class="va">FFQ.N.2</span>, Q.E.1<span class="op">=</span> <span class="va">Data</span><span class="op">$</span><span class="va">FFQ.E.1</span>, Q.E.2<span class="op">=</span> <span class="va">Data</span><span class="op">$</span><span class="va">FFQ.E.2</span>, F.N.1<span class="op">=</span> <span class="va">Data</span><span class="op">$</span><span class="va">Ref.N.1</span>, F.N.2<span class="op">=</span> <span class="va">Data</span><span class="op">$</span><span class="va">Ref.N.2</span>, F.E.1<span class="op">=</span> <span class="va">Data</span><span class="op">$</span><span class="va">Ref.E.1</span>, F.E.2<span class="op">=</span> <span class="va">Data</span><span class="op">$</span><span class="va">Ref.E.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $est.coefficients</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          est.coeff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rho.N          NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda.N       NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rho.E          NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda.E       NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rho.R          NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lambda.R       NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pei Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

